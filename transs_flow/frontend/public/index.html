<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Basic Meta -->
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <meta name="theme-color" content="#0ea5e9" />
    <meta
      name="description"
      content="Transs Flow IPQC – Progressive Web App for Quality and Production Control"
    />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />

    <!-- App Icons -->
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <link
      rel="apple-touch-icon"
      href="%PUBLIC_URL%/logo192.png"
    />
    <link
      rel="icon"
      type="image/png"
      href="%PUBLIC_URL%/favicon.ico"
    />

    <!-- Title -->
    <title>Transs Flow PWA</title>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />

    <!-- Optional custom CSS (match Django theme) -->
    <link rel="stylesheet" href="/static/css/style.css" />

    <!-- Safe area fix for iPhones -->
    <style>
      body {
        padding-bottom: env(safe-area-inset-bottom);
        background: #f9fafb;
        color: #1f2937;
        font-family: 'Inter', system-ui, sans-serif;
      }

      /* Loading splash screen before React loads */
      #splash-screen {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
        text-align: center;
        background: white;
      }

      #splash-screen i {
        color: #0ea5e9;
        font-size: 48px;
        margin-bottom: 12px;
        animation: pulse 1.5s infinite;
      }

      @keyframes pulse {
        0% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
        100% {
          opacity: 1;
        }
      }

      /* Bottom nav styling */
      .bottom-nav {
        position: fixed;
        bottom: 0;
        left: 0;
        right: 0;
        background: white;
        border-top: 1px solid #e5e7eb;
        display: flex;
        justify-content: space-around;
        padding: 8px 0;
        z-index: 50;
      }

      .bottom-nav a {
        text-align: center;
        color: #6b7280;
        font-size: 12px;
        flex: 1;
      }

      .bottom-nav a.active {
        color: #0ea5e9;
      }

      .bottom-nav i {
        display: block;
        font-size: 20px;
        margin-bottom: 2px;
      }
    </style>
  </head>

  <body>
    <!-- Splash Screen (until React loads) -->
    <div id="splash-screen">
      <i class="fas fa-circle-notch fa-spin"></i>
      <p class="text-gray-600 text-sm">Loading Transs Flow...</p>
    </div>

    <!-- React Root -->
    <div id="root" style="display:none"></div>

    <!-- Bottom Navigation (static fallback for PWA) -->
    <nav class="bottom-nav">
      <a href="/ipqc/" class="active">
        <i class="fas fa-home"></i>
        <span>Home</span>
      </a>
      <a href="/ipqc/work-info/">
        <i class="fas fa-clipboard-list"></i>
        <span>Work Info</span>
      </a>
      <a href="/ipqc/operator-qualification/create/">
        <i class="fas fa-user-check"></i>
        <span>Operator</span>
      </a>
      <a href="/ipqc/audit/">
        <i class="fas fa-search"></i>
        <span>Audit</span>
      </a>
      <a href="/accounts/logout/">
        <i class="fas fa-sign-out-alt"></i>
        <span>Logout</span>
      </a>
    </nav>

    <!-- Service Worker -->
    <script>
      if ("serviceWorker" in navigator) {
        window.addEventListener("load", () => {
          navigator.serviceWorker
            .register("/sw.js")
            .then(() => console.log("✅ Service Worker registered"))
            .catch((err) => console.error("SW registration failed:", err));
        });
      }
    </script>

    <!-- React will mount here -->
    <script>
      window.addEventListener("DOMContentLoaded", () => {
        const splash = document.getElementById("splash-screen");
        const root = document.getElementById("root");
        setTimeout(() => {
          splash.style.display = "none";
          root.style.display = "block";
        }, 800); // small delay to simulate loading
      });
    </script>
  </body>
</html>
