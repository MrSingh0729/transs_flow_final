	{% extends 'base.html' %}
	{% load static %}
	{% block title %}Work Info{% endblock %}
	{% block content %}
	<style>
	/* Clean form styles */
	.work-info-form {
	    max-width: 1200px;
	    margin: 0 auto;
	    padding: 20px;
	}
	/* Header section */
	.page-header {
	    background: white;
	    border: 1px solid var(--border);
	    border-radius: 12px;
	    padding: 24px;
	    margin-bottom: 24px;
	 Box-Shadow: 0 2px 8px rgba(0,0,0,0.05);
	}
	.page-title {
	    font-size: 28px;
	    font-weight: 700;
	    color: var(--text-primary);
	    display: flex;
	    align-items: center;
	    gap: 12px;
	    margin-bottom: 8px;
	}
	.page-subtitle {
	    color: var(--text-secondary);
	    font-size: 16px;
	}
	/* Stats cards */
	.stats-grid {
	    display: grid;
	    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
	    gap: 20px;
	    margin-bottom: 24px;
	}
	.stat-card {
	    background: white;
	    border: 1px solid var(--border);
	    border-radius: 12px;
	    padding: 20px;
	    display: flex;
	    align-items: center;
	    gap: 16px;
	    transition: all 0.2s ease;
	}
	.stat-card:hover {
	 Box-Shadow: 0 4px 16px rgba(0,0,0,0.08);
	    transform: translateY(-2px);
	}
	.stat-icon {
	    width: 48px;
	    height: 48px;
	    border-radius: 10px;
	    display: flex;
	    align-items: center;
	    justify-content: center;
	    flex-shrink: 0;
	}
	.stat-content {
	    flex: 1;
	}
	.stat-value {
	    font-size: 28px;
	    font-weight: 700;
	    color: var(--text-primary);
	    line-height: 1;
	    margin-bottom: 4px;
	}
	.stat-label {
	    font-size: 14px;
	    color: var(--text-secondary);
	    font-weight: 500;
	}
	/* Form section */
	.form-section {
	    background: white;
	    border: 1px solid var(--border);
	    border-radius: 12px;
	    padding: 24px;
	    margin-bottom: 24px;
	    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
	}
	.section-title {
	    font-size: 20px;
	    font-weight: 700;
	    color: var(--text-primary);
	    display: flex;
	    align-items: center;
	    gap: 12px;
	    margin-bottom: 24px;
	    padding-bottom: 16px;
	    border-bottom: 1px solid var(--border);
	}
	.form-grid {
	    display: grid;
	    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
	    gap: 20px;
	}
	.form-group {
	    display: flex;
	    flex-direction: column;
	    position: relative;
	}
	.form-group label {
	    font-size: 14px;
	    font-weight: 600;
	    color: var(--text-primary);
	    margin-bottom: 8px;
	    display: flex;
	    align-items: center;
	    gap: 8px;
	}
	.form-group label i {
	    width: 16px;
	    text-align: center;
	    color: var(--primary);
	}
	.form-group input,
	.form-group select {
	    width: 100%;
	    padding: 12px 16px;
	    background: white;
	    border: 2px solid var(--border);
	    border-radius: 8px;
	    color: var(--text-primary);
	    font-size: 15px;
	    transition: all 0.2s ease;
	    font-family: inherit;
	    box-sizing: border-box;
	}
	.form-group input:focus,
	.form-group select:focus {
	    outline: none;
	    border-color: var(--primary);
	    box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
	}
	.form-group input[readonly] {
	    background: var(--bg-secondary);
	    color: var(--text-secondary);
	    cursor: not-allowed;
	}
	/* Search suggestions */
	.suggestions-box {
	    position: absolute;
	    top: 100%;
	    left: 0;
	    right: 0;
	    background: white;
	    border: 1px solid var(--border);
	    border-radius: 8px;
	    margin-top: 4px;
	    z-index: 1000;
	    max-height: 200px;
	    overflow-y: auto;
	    box-shadow: 0 4px 16px rgba(0,0,0,0.1);
	    display: none;
	}
	.suggestions-box.show {
	    display: block;
	}
	.suggestion-item {
	    padding: 12px 16px;
	    cursor: pointer;
	    border-bottom: 1px solid #f1f5f9;
	    transition: background 0.2s ease;
	}
	.suggestion-item:last-child {
	    border-bottom: none;
	}
	.suggestion-item:hover {
	    background: var(--bg-secondary);
	    color: var(--primary);
	}
	/* Buttons */
	.btn {
	    padding: 12px 24px;
	    border-radius: 8px;
	    font-weight: 600;
	    font-size: 15px;
	    border: none;
	    cursor: pointer;
	    transition: all 0.2s ease;
	    display: inline-flex;
	    align-items: center;
	    gap: 8px;
	    text-decoration: none;
	    min-height: 48px;
	}
	.btn-primary {
	    background: var(--primary);
	    color: white;
	    box-shadow: 0 2px 4px rgba(14, 165, 233, 0.2);
	}
	.btn-primary:hover {
	    background: var(--primary-dark);
	    transform: translateY(-1px);
	    box-shadow: 0 4px 12px rgba(14, 165, 233, 0.3);
	}
	.btn-primary:disabled {
	    opacity: 0.6;
	    cursor: not-allowed;
	    transform: none;
	}
	.btn-secondary {
	    background: white;
	    color: var(--text-secondary);
	    border: 2px solid var(--border);
	}
	.btn-secondary:hover {
	    background: var(--bg-secondary);
	    border-color: var(--primary);
	    color: var(--primary);
	}
	/* Submit section */
	.submit-section {
	    display: flex;
	    justify-content: center;
	    margin-top: 32px;
	    padding-top: 24px;
	    border-top: 1px solid var(--border);
	}
	/* Recent records table */
	.table-section {
	    background: white;
	    border: 1px solid var(--border);
	    border-radius: 12px;
	    padding: 24px;
	    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
	}
	.table-header {
	    font-size: 20px;
	    font-weight: 700;
	    color: var(--text-primary);
	    display: flex;
	    align-items: center;
	    gap: 12px;
	    margin-bottom: 20px;
	    padding-bottom: 16px;
	    border-bottom: 1px solid var(--border);
	}
	.data-table {
	    width: 100%;
	    border-collapse: collapse;
	    font-size: 14px;
	}
	.data-table thead {
	    background: var(--bg-secondary);
	}
	.data-table th {
	    padding: 12px 16px;
	    text-align: left;
	    font-weight: 600;
	    color: var(--text-primary);
	    border-bottom: 2px solid var(--border);
	    font-size: 13px;
	    text-transform: uppercase;
	    letter-spacing: 0.5px;
	}
	.data-table td {
	    padding: 12px 16px;
	    border-bottom: 1px solid #f1f5f9;
	    color: var(--text-primary);
	}
	.data-table tbody tr {
	    transition: background 0.2s ease;
	}
	.data-table tbody tr:hover {
	    background: var(--bg-secondary);
	}
	.data-table .no-records {
	    text-align: center;
	    color: var(--text-secondary);
	    padding: 32px 16px;
	    font-style: italic;
	}
	/* Action buttons */
	.action-btn {
	    background: transparent;
	    border: none;
	    color: var(--primary);
	    cursor: pointer;
	    padding: 8px;
	    border-radius: 4px;
	    transition: all 0.2s ease;
	    display: inline-flex;
	    align-items: center;
	    justify-content: center;
	}
	.action-btn:hover {
	    background: rgba(14, 165, 233, 0.1);
	    color: var(--primary-dark);
	}
	/* Loading state */
	.loading {
	    display: inline-flex;
	    align-items: center;
	    gap: 8px;
	}
	.spinner {
	    width: 16px;
	    height: 16px;
	    border: 2px solid rgba(255,255,255,0.3);
	    border-top-color: white;
	    border-radius: 50%;
	    animation: spin 0.6s linear infinite;
	}
	@keyframes spin {
	    to { transform: rotate(360deg); }
	}
	/* Alert styles */
	.alert {
	    padding: 12px 16px;
	    border-radius: 8px;
	    margin-bottom: 20px;
	    display: flex;
	    align-items: center;
	    gap: 12px;
	    font-weight: 500;
	}
	.alert-success {
	    background: rgba(34, 197, 94, 0.1);
	    color: var(--success);
	    border: 1px solid rgba(34, 197, 94, 0.2);
	}
	.alert-error {
	    background: rgba(239, 68, 68, 0.1);
	    color: var(--danger);
	    border: 1px solid rgba(239, 68, 68, 0.2);
	}
	/* Responsive adjustments */
	@media (max-width: 768px) {
	    .work-info-form {
	        padding: 16px;
	    }
	    .page-header,
	    .form-section,
	    .table-section {
	        padding: 16px;
	        margin-bottom: 16px;
	    }
	    .form-grid {
	        grid-template-columns: 1fr;
	        gap: 16px;
	    }
	    .stats-grid {
	        grid-template-columns: 1fr;
	        gap: 12px;
	    }
	    .page-title {
	        font-size: 24px;
	    }
	    .stat-card {
	        padding: 16px;
	    }
	    .stat-icon {
	        width: 40px;
	        height: 40px;
	    }
	    .stat-value {
	        font-size: 24px;
	    }
	    .data-table {
	        font-size: 12px;
	    }
	    .data-table th,
	    .data-table td {
	        padding: 8px 12px;
	    }
	    /* Mobile table scroll */
	    .table-container {
	        overflow-x: auto;
	        -webkit-overflow-scrolling: touch;
	    }
	}
	/* Touch optimizations */
	@media (hover: none) and (pointer: coarse) {
	    .btn {
	        min-height: 44px;
	    }
	    .action-btn {
	        min-height: 44px;
	        min-width: 44px;
	    }
	}
	/* Print friendly */
	@media print {
	    .submit-section,
	    .action-btn {
	        display: none !important;
	    }
	    .page-header,
	    .form-section,
	    .table-section {
	        box-shadow: none;
	        border: 1px solid #000;
	    }
	}
	</style>
	<div class="work-info-form">
	    <!-- Header -->
	    <div class="page-header">
	        <h1 class="page-title">
	            <i class="fas fa-clipboard-list" style="color: var(--primary);"></i>
	            Work Information Entry
	        </h1>
	        <p class="page-subtitle">Record daily manufacturing work details</p>
	    </div>
	    <!-- Stats Cards -->
	    <div class="stats-grid">
	        <div class="stat-card">
	            <div class="stat-icon bg-sky-100">
	                <i class="fas fa-calendar-day text-sky-600 text-xl"></i>
	            </div>
	            <div class="stat-content">
	                <div class="stat-value">{{ today_records|default:"0" }}</div>
	                <div class="stat-label">Today</div>
	            </div>
	        </div>
	        <div class="stat-card">
	            <div class="stat-icon bg-purple-100">
	                <i class="fas fa-calendar-week text-purple-600 text-xl"></i>
	            </div>
	            <div class="stat-content">
	                <div class="stat-value">{{ week_records|default:"0" }}</div>
	                <div class="stat-label">This Week</div>
	            </div>
	        </div>
	        <div class="stat-card">
	            <div class="stat-icon bg-pink-100">
	                <i class="fas fa-calendar text-pink-600 text-xl"></i>
	            </div>
	            <div class="stat-content">
	                <div class="stat-value">{{ total_records|default:"0" }}</div>
	                <div class="stat-label">Total Records</div>
	            </div>
	        </div>
	    </div>
	    <!-- Form Section -->
	    <div class="form-section">
	        <h2 class="section-title">
	            <i class="fas fa-edit" style="color: var(--primary);"></i>
	            Work Details
	        </h2>
	        <form method="post" id="workInfoForm">
	            {% csrf_token %}
	            <!-- Employee Info and Date -->
	            <div class="form-grid">
	                <div class="form-group">
	                    <label for="emp_id">
	                        <i class="fas fa-id-badge"></i>
	                        Employee ID
	                    </label>
	                    <input type="text" id="emp_id" name="emp_id" 
	                           value="{{ user_emp_id|default:'' }}" readonly>
	                </div>
	                <div class="form-group">
	                    <label for="emp_name">
	                        <i class="fas fa-user"></i>
	                        Employee Name
	                    </label>
	                    <input type="text" id="emp_name" name="emp_name" 
	                           value="{{ user_name|default:'' }}" readonly>
	                </div>
	                <div class="form-group">
	                    <label for="date">
	                        <i class="fas fa-calendar"></i>
	                        Date
	                    </label>
	                    <input type="date" id="date" name="date" required>
	                </div>
	            </div>
	            <!-- Line, Section and Shift -->
	            <div class="form-grid">
	                <div class="form-group">
	                    <label for="shift">
	                        <i class="fas fa-clock"></i>
	                        Shift
	                    </label>
	                    <select id="shift" name="shift" required>
	                        <option value="">Select Shift</option>
	                        <option value="Day" {% if form.shift.value == 'Day' %}selected{% endif %}>Day</option>
	                        <option value="Night" {% if form.shift.value == 'Night' %}selected{% endif %}>Night</option>
	                    </select>
	                </div>
	                <div class="form-group">
	                    <label for="section">
	                        <i class="fas fa-industry"></i>
	                        Section
	                    </label>
	                    <select id="section" name="section" required>
	                        <option value="">Select Section</option>
	                        <option value="Assembly" {% if form.section.value == 'Assembly' %}selected{% endif %}>Assembly</option>
	                        <option value="NT" {% if form.section.value == 'NT' %}selected{% endif %}>NT</option>
	                        <option value="SMT" {% if form.section.value == 'SMT' %}selected{% endif %}>SMT</option>
	                    </select>
	                </div>
	                <div class="form-group">
	                    <label for="line">
	                        <i class="fas fa-sitemap"></i>
	                        Line
	                    </label>
	                    <input type="text" id="line" name="line" 
	                           placeholder="Type to search line..." autocomplete="off" required>
	                    <div id="line-suggestions" class="suggestions-box"></div>
	                </div>
	            </div>
	            <!-- Group, Model and Color -->
	            <div class="form-grid">
	                <div class="form-group">
	                    <label for="group">
	                        <i class="fas fa-users"></i>
	                        Group
	                    </label>
	                    <input type="text" id="group" name="group" 
	                           placeholder="Type to search group..." autocomplete="off" required>
	                    <div id="group-suggestions" class="suggestions-box"></div>
	                </div>
	                <div class="form-group">
	                    <label for="model">
	                        <i class="fas fa-cube"></i>
	                        Model
	                    </label>
	                    <input type="text" id="model" name="model" 
	                           placeholder="Type to search model..." autocomplete="off" required>
	                    <div id="model-suggestions" class="suggestions-box"></div>
	                </div>
	                <div class="form-group">
	                    <label for="color">
	                        <i class="fas fa-palette"></i>
	                        Color
	                    </label>
	                    <input type="text" id="color" name="color" 
	                           value="{{ form.color.value|default:'' }}" required
	                           placeholder="Enter color code">
	                </div>
	            </div>
	            <!-- Submit Button -->
	            <div class="submit-section">
	                <button type="submit" class="btn btn-primary" id="submitBtn">
	                    <i class="fas fa-save"></i>
	                    Submit Work Information
	                </button>
	            </div>
	        </form>
	    </div>
	    <!-- Recent Records Table -->
	    <div class="table-section">
	        <h2 class="table-header">
	            <i class="fas fa-history" style="color: var(--primary);"></i>
	            Recent Records
	        </h2>
	        <div class="table-container">
	            <table class="data-table">
	                <thead>
	                    <tr>
	                        <th>Date</th>
	                        <th>Shift</th>
	                        <th>Section</th>
	                        <th>Line</th>
	                        <th>Model</th>
	                        <th>Color</th>
	                        <th>Actions</th>
	                    </tr>
	                </thead>
	                <tbody>
	                    {% for record in recent_records %}
	                    <tr>
	                        <td>{{ record.date }}</td>
	                        <td>{{ record.shift }}</td>
	                        <td>{{ record.section }}</td>
	                        <td>{{ record.line }}</td>
	                        <td>{{ record.model }}</td>
	                        <td>{{ record.color }}</td>
	                        <td>
	                            <button class="action-btn" title="Edit Record">
	                                <i class="fas fa-edit"></i>
	                            </button>
	                        </td>
	                    </tr>
	                    {% empty %}
	                    <tr>
	                        <td colspan="7" class="no-records">No recent records found.</td>
	                    </tr>
	                    {% endfor %}
	                </tbody>
	            </table>
	        </div>
	    </div>
	</div>
	<script>
	// Set current date on page load
	function setCurrentDate() {
	    const today = new Date();
	    const dateStr = today.getFullYear() + '-' + 
	                   String(today.getMonth() + 1).padStart(2, '0') + '-' + 
	                   String(today.getDate()).padStart(2, '0');
	    document.getElementById('date').value = dateStr;
	}
	// Search suggestions functionality
	function setupSearchBox(inputId, suggestionsId, apiUrl) {
	    const input = document.getElementById(inputId);
	    const suggestionsBox = document.getElementById(suggestionsId);
	    let debounceTimer;
	    input.addEventListener('input', function() {
	        const query = this.value.trim();
	        clearTimeout(debounceTimer);
	        if (query.length < 1) {
	            hideSuggestions();
	            return;
	        }
	        debounceTimer = setTimeout(async () => {
	            try {
	                const response = await fetch(`${apiUrl}?q=${encodeURIComponent(query)}`);
	                const data = await response.json();
	                showSuggestions(data, suggestionsId, inputId);
	            } catch (error) {
	                console.error('Error fetching suggestions:', error);
	                hideSuggestions();
	            }
	        }, 300);
	    });
	    // Hide suggestions when clicking outside
	    document.addEventListener('click', function(e) {
	        if (!input.contains(e.target) && !suggestionsBox.contains(e.target)) {
	            hideSuggestions();
	        }
	    });
	    function showSuggestions(data, suggestionsId, inputId) {
	        const box = document.getElementById(suggestionsId);
	        box.innerHTML = '';
	        if (data.length === 0) {
	            box.classList.remove('show');
	            return;
	        }
	        data.forEach(item => {
	            const div = document.createElement('div');
	            div.className = 'suggestion-item';
	            div.textContent = item.text || item.name || item;
	            div.onclick = function() {
	                document.getElementById(inputId).value = item.text || item.name || item;
	                hideSuggestions();
	            };
	            box.appendChild(div);
	        });
	        box.classList.add('show');
	    }
	    function hideSuggestions() {
	        document.querySelectorAll('.suggestions-box').forEach(box => {
	            box.classList.remove('show');
	        });
	    }
	}
	// Form submission with loading state
	function setupFormSubmission() {
	    const form = document.getElementById('workInfoForm');
	    const submitBtn = document.getElementById('submitBtn');
	    form.addEventListener('submit', function(e) {
	        e.preventDefault();
	        // Show loading state
	        submitBtn.innerHTML = '<div class="loading"><div class="spinner"></div> Submitting...</div>';
	        submitBtn.disabled = true;
	        // Submit form normally (or via AJAX if needed)
	        setTimeout(() => {
	            form.submit();
	        }, 1000);
	    });
	}
	// Show alert messages
	function showAlert(message, type = 'success') {
	    // Remove existing alerts
	    const existingAlert = document.querySelector('.alert');
	    if (existingAlert) {
	        existingAlert.remove();
	    }
	    // Create new alert
	    const alert = document.createElement('div');
	    alert.className = `alert alert-${type}`;
	    alert.innerHTML = `
	        <i class="fas fa-${type === 'success' ? 'check-circle' : 'exclamation-triangle'}"></i>
	        ${message}
	    `;
	    // Insert at top of form
	    const formSection = document.querySelector('.form-section');
	    formSection.insertBefore(alert, formSection.firstChild);
	    // Remove after 5 seconds
	    setTimeout(() => {
	        if (alert.parentElement) {
	            alert.remove();
	        }
	    }, 5000);
	}
	// Initialize on page load
	document.addEventListener('DOMContentLoaded', function() {
	    setCurrentDate();
	    // Setup search boxes
	    setupSearchBox('line', 'line-suggestions', '{% url "ajax_get_lines" %}');
	    setupSearchBox('group', 'group-suggestions', '{% url "ajax_get_groups" %}');
	    setupSearchBox('model', 'model-suggestions', '{% url "ajax_get_models" %}');
	    // Setup form submission
	    setupFormSubmission();
	    // Add keyboard navigation for suggestions
	    document.addEventListener('keydown', function(e) {
	        if (e.key === 'Escape') {
	            document.querySelectorAll('.suggestions-box').forEach(box => {
	                box.classList.remove('show');
	            });
	        }
	    });
	});
	// Mobile optimizations
	if ('ontouchstart' in window) {
	    document.body.classList.add('touch-device');
	}
	</script>
	{% endblock %}